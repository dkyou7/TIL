[toc]

# [섹션1] JPA 소개

- 객체와 테이블을 제대로 설계하고 매핑하는 방법
- 기본키와 왜래 키 매핑
- 1:N, N:1,1:1,N:M 매핑
- 실무 노하우 + 성능
- 어떤 복잡한 시스템도 JPA로 설계 가능

## 0. 목표

### JPA 내부 동작 방식 이해

- JPA가 어떤 SQL을 만들어내는지 이해
- JPA가 언제 SQL을 실행하는지 이해

### 학습 방법

- 1단계 ~ 6단계 리팩토링

- 강의를 메인으로 하고, 책은 참고서로 추천
- 총 16시간으로 하루 한시간 반, 2주 완성으로 가자.

 ### JPA 검증 사례

- 우형, 쿠팡, 카카오, 네이버
- 조 단위의 거래금액이 발생하는 다양한 서비스에서 사용, 검증됨

### JPA 실무 경험담

- 경험한 이전과 후로 나뉜다.
- SQL 작성으로 시간 낭비 ㄴㄴ
- 설계 고민, 테스트코드 고민하기

## 1. SQL 중심적인 개발의 문제점

- 지금 시대는 객체를 관계형 DB에 넣어 관리하고 있다.	
  - DB는 SQL을 인식하므로 SQL에 의존한다.
- 무한 반복, 지루한 코드에 지침
- 패러다임의 불일치
  - 객체 vs 관계형 데이터베이스
- 자바컬렉션에서 객체로 놀면 되는데 디비로 하기가 너무 껄끄럽다.
- **자바 컬렉션**이라는 용어가 계속 나온다.

- 눈으로 쿼리를 확인하기 전까지는 엔티티를 신뢰할 수 없다!
  - 재대로된 JPA를 배우자.
- 계층분할이 쉽지가 않다.
- 객체답게 모델링 할수록 매핑작업만 늘어난다.
  - 객체지향적으로 작업할수록 피곤해진다.
  - SQL에 맞추기 때문에
- 객체를 자바 컬렉션에 저장 하듯 DB에 저장할 수는 없을까???
  - JPA

## 2. JPA 소개

- Java Persistence API
- ORM 기술 적용
- Object-Relational mapping(객체 관계 매핑)

![image](https://user-images.githubusercontent.com/26649731/76941486-7b41fe00-693f-11ea-9867-b2d57bae45e1.png)

![image](https://user-images.githubusercontent.com/26649731/76941542-94e34580-693f-11ea-88fd-782bd3bdc166.png)

- 패러다임의 불일치를 해결해준다.

- 하이버네이트 만든사람 데려와서 자바 표준 구현해낸게 JPA이다.
- 저장, 조회, 수정, 삭제 코드가 만들어져있다.
  - 그 중에서도 수정기능은 너무좋다.
- 유지보수는 더좋다.
- JPA와 패러다임의 불일치 해결
- 상속관계면 두번 쿼리 날려준다. 

![image](https://user-images.githubusercontent.com/26649731/76942483-299a7300-6941-11ea-9071-a72486d42542.png)

![image](https://user-images.githubusercontent.com/26649731/76942543-40d96080-6941-11ea-92a1-7f6ac4964cef.png)

- JPA의 성능 최적화 기능

  - ![image](https://user-images.githubusercontent.com/26649731/76943290-729ef700-6942-11ea-9397-68f8700e9607.png)

  - ![image](https://user-images.githubusercontent.com/26649731/76943449-b98cec80-6942-11ea-8182-37ec3450be83.png)
  - ![image](https://user-images.githubusercontent.com/26649731/76943574-f22cc600-6942-11ea-93c8-80c2480b29c3.png)
  - 쿼리 수를 줄일 수 있다. 옵션을 적용한다.
  - 상황에 따라 로딩 전략을 짤 수 있음.

- ORM은 객체와 RDB 두 기둥 위에 있는 기술이다. 둘 사이에 벨런스를 맞춰야한다.